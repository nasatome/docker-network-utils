# Ofelia Cron Jobs Configuration
# Schedule format: seconds minutes hours day-of-month month day-of-week
#
# Discord notifications: Create .discord-webhook file with your webhook URL
# echo "https://discord.com/api/webhooks/ID/TOKEN" > .discord-webhook

# Update Cloudflare trusted IPs weekly (Sunday 6PM CDMX)
# Downloads official IP ranges, updates .env, restarts Traefik
[job-run "cloudflare-ips"]
schedule = 0 0 18 * * 0
image = alpine:latest
network = reverse_traefik
volume = /var/run/docker.sock:/var/run/docker.sock
volume = /opt/prj/docker-network-utils/reverse-proxy/traefik/.env:/etc/traefik-env/.env
volume = /opt/prj/docker-network-utils/reverse-proxy/traefik/.discord-webhook:/etc/discord-webhook:ro
volume = /opt/prj/docker-network-utils/reverse-proxy/traefik/scripts:/scripts:ro
command = sh -c 'apk add -q curl docker-cli && /scripts/update-cloudflare-ips.sh'
